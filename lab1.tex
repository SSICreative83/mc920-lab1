\documentclass[10pt,a4paper]{article}
\usepackage[T1]{fontenc}
\usepackage[brazil]{babel}
\usepackage[utf8]{inputenc}


\usepackage{ae,aecompl}
\usepackage{pslatex}
\usepackage{epsfig}
\usepackage{geometry}
\usepackage{url}
\usepackage{textcomp}
\usepackage{ae}
\usepackage{subfig}
\usepackage{indentfirst}
\usepackage{textcomp}
\usepackage{color}
\usepackage{setspace}
\usepackage{verbatim}
\usepackage{mathtools}
\usepackage{amsmath}


\usepackage[compact]{titlesec}
\titlespacing{\section}{0pt}{*0}{*0}
\titlespacing{\subsection}{0pt}{*0}{*0}
\titlespacing{\subsubsection}{0pt}{*0}{*0}

\linespread{1.5}
\geometry{ 
	a4paper,	% Formato do papel
	tmargin=30mm,	% Margem superior
	bmargin=30mm,	% Margem inferior
	lmargin=20mm,	% Margem esquerda
	rmargin=20mm,	% Margem direita
	footskip=20mm	% Espaço entre o rodapé e o fim do texto
}
\include{abaco} 
\renewcommand{\thetable}{\Roman{table}}
\newcommand{\x} {$\bullet$}


\begin{document}
% CAPA
\begin{titlepage}
\thispagestyle{empty}
  \begin{center} {\large \textbf{UNIVERSIDADE~ESTADUAL~DE~CAMPINAS}} \end{center}
  \begin{center} {\large INSTITUTO~DE~COMPUTAÇÃO}                    \end{center}
  \vspace{0.1cm}
  \begin{center}
  \begin{minipage}[tl]{31mm}
    \ABACO{1}{9}{6}{9}{1}
  \end{minipage}
  \end{center}
  \vspace{0.3cm}
  \begin{center} 
    {\large \textsc{São totalmente válidas algumas das considerações sobre a
Correlação de Pearson presentes na literatura?  }} 
    \\\vspace{0.5cm}
    {\textsl{Relatório do primeiro laboratório de MC920}}
    \\\vspace{1cm}
    \begin{tabular}{rl}
	  \textbf{Aluno}:   Carlos~Eduardo~Machado &  
	  \textbf{RA}:          059582 \\ 
	  \textbf{Aluno}:        Tiago~Chedraoui~Silva & 
	  \textbf{RA}:        082941 \\
	  \textbf{Aluno}:        William~Marques~Dias & 
	  \textbf{RA}:        065106 \\
	\end{tabular}
  \end{center}
  \vspace{0.5cm}

  \begin{abstract}
O coeficiente de correlação de Pearson é amplamente usado para
comparar imagens, contudo ele apresenta sérias limitações. Esse
trabalho consistiu na validação da análise realizada no Artigo ''The
Ineffectiveness of the Correlation Coefficient for Image Comparisons''.
  \end{abstract}
  % Sumário
  \tableofcontents
\end{titlepage} 

\vspace{2mm}
\newpage

\section{Introdução}
O coeficiente de correlação de Pearson é amplamente amplamente
utilizado na análise estatística, reconhecimento de padrões e
processamento de imagens.
Na área de processamento de imagens ele é utilizado na comparação de
duas imagens para fins de registro de imagens, reconhecimento de
objetos, e medição disparidade. Para imagens digitais monocromáticas, a correlação de Pearson é definido como :

\begin{equation}r = \frac{  
\displaystyle{\sum_{i} (x_i-\bar{x})(y_i-  
\bar{y})}}{\displaystyle{\left[  
\sum_{i}(x_i-\bar{x})^2  
\sum_{i}(y_i-\bar{y})^2\right]^{1/2}}}  \label{eq:r}
\end{equation}  

Onde $x_i$ é a intensidade dos pixels na imagem 1, $y_i$ é a
intensidade dos pixels na imagem 2,$\bar{x}$ é a intensidade média da
imagem 1 e $\bar{y}$ é a intensidade média da imagem 2.

O coeficiente tem valor $r=1$ se as duas imagens são absolutamente
idênticas, $r=0$ se são totalmente não correlacionadas e $r=-1$ se elas
são totalmente anti-correlacionadas, por exemplo se uma imagem é o
negativo da outra.

O coeficiente de Pearson pode ser utilizado em
aplicações de segurança, como, por exemplo, vigilância. Normalmente, 
o coeficiente de relação é usado para comparar duas imagens do mesmo
objeto ou cena durante vários momentos diferentes.

Não obstante à sua utilização, o coeficiente de correlação possui
diversas limitação, sendo considerado ineficaz em alguns papers.% ~\cite{paper}.
 
Assim, o objetivo deste trabalho é apresentar, através de exemplos, o
desempenho do coeficiente para comparações de imagens, especialmente
em aplicações de segurança e, posteriormente, compará-las às considerações existentes na literatura.

%O paper é organizado a seção conclui

\section{Métodos}

Desenvolveu-se em python um programa de análise de imagens baseada no
coeficiente de correlação de Pearson. 
Dado duas imagens para analisar duas imagens, sendo a imagem original dada por $x$  e a
imagem modificada por $y$ na equação \eqref{eq:r}, retorna-se o valor de $r$.

Inicialmente, para a análise do coeficiente, utilizou-se algumas imagens
previamente analisadas no artigo ´´The Ineffectiveness of the Correlation
Coefficient for Image Comparisons'' através do qual pretendíamos
confirmar os resultados obtidos.

Posteriormente, procurou-se alterar outra imagem com a
sobreposição de outra imagem. Alterou-se algumas características da
imagem sobreposta, como por exemplo, a posição, a opacidade, para
analisar os efeitos no cálculo do coeficiente produzidos por tais modificações. 

% \subsection{Código}

\newpage
\section{Comparação de imagens}

Para a comparação de imagens através do coeficiente, foram realizados diferentes testes
. As seções a seguir apresentam as variações dos testes: utilização
das mesmas figuras do artigo ´´The Ineffectiveness of the Correlation
Coefficient for Image Comparisons'', sobreposição de imagem , remoção de objetos, detecção
de movimentos e alteração de luminosidade.  

\subsection{Figuras do artigo }
Utilizando as figuras \ref{fig1} e \ref{fig1Diff} usados no artigo ´´The Ineffectiveness of the Correlation
Coefficient for Image Comparisons'', na qual há uma simples
sobreposição de uma palavra sobre a imagem, obtemos um valor de r de
aproximadamente 0.89, enquanto no artigo o valor de r obtido vale 0.94.

\begin{figure}[h!]
\begin{center}
\subfloat[Imagem original]{\includegraphics[scale=0.35]{photos/c1a}\label{fig1}}
\hspace{10mm}
\subfloat[Sobreposição de uma palavra sobre a imagem]{\includegraphics[scale=0.35]{photos/c1b}\label{fig1Diff}}
\caption{Comparação entre uma imagem original e outra com sobreposição
  de palavra}
\end{center}
\end{figure}

Para as imagens \ref{fig2} e \ref{fig2Diff}, na qual retira-se um
clips da imagem original, obteu-se um valor de $r\approx 0.90$
enquanto no artigo $r\approx 0.98$.
%figura clips

\begin{figure}[h!]
\begin{center}
\subfloat[Original]{\includegraphics[scale=0.35]{photos/c2a}\label{fig2}}
\hspace{10mm}
\subfloat[Remoção de um clips na imagem original]{\includegraphics[scale=0.35]{photos/c2b}\label{fig2Diff}}
\caption{Comparação entre imagem com um objeto e outra sem esse objeto
 }
\end{center}
\end{figure}

\newpage
\subsection{Sobreposição de imagem}
Para a imagem original \ref{fig3}, houve uma sobreposição da palavra
''CWT'' na imagem \ref{fig3Diff1} e na imagem \ref{fig3Diff2},
porém em posição diferente. Obteve-se para a imagem \ref{fig3Diff1}
um valor de $r\approx 0.99$ se comparado à original e para a imagem \ref{fig3Diff2} 
um valor de $r\approx 0.98$.
%m15 fig1
\begin{figure}[h!]
\begin{center}
\includegraphics[scale=0.25]{photos/m15_tricome}\label{fig3}
\caption{Figura original a ser comparada}
\end{center}
\end{figure}



\vspace{-0.5cm}
%m15 fig1
\begin{figure}[h!]
\begin{center}
\subfloat[Sobreposição da palavra CTW na figura original ]{\includegraphics[scale=0.18]{photos/m15_tricome_b}\label{fig3Diff1}}
\hspace{5mm}
\subfloat[Alteração da posição da palavra CTW  ]{\includegraphics[scale=0.18]{photos/m15_tricome_c}\label{fig3Diff2}}
\caption{Comparação entre a foto original e duas fotos compostas pela
  sobreposição de uma palavra à imagem original}
\end{center}
\end{figure}

\vspace{-0.5cm}
Para a imagem original \ref{fig3}, a imagem de Lena foi sobreposta nas
imagens \ref{fig3Diff3} e \ref{fig3Diff4}, sendo a primeira mais
transparente.
Se comparado à imagem original as imagens \ref{fig3Diff3} e
\ref{fig3Diff4} apresentam, respectivamente, $r\approx 0.93$ e
$r\approx 0.90$ . 
%m15 fig1
\begin{figure}[h!]
\begin{center}
\subfloat[Sobreposição da foto de Lena com grau de transparência maior
 ]{\includegraphics[scale=0.18]{photos/m15_tricome_d}\label{fig3Diff3}}
\hspace{10mm}
\subfloat[Sobreposição  da foto de Lena com grau de transparência
menor ]{\includegraphics[scale=0.18]{photos/m15_tricome_e}\label{fig3Diff4}}
\caption{Comparação entre a imagem original e duas imagens compostas pela sobreposição
  de uma outra imagem à imagem original}
\end{center}
\end{figure}

\newpage
\subsection{Remoção de objeto}
%-%-%-%-%-%-%-%
%livros remocao 
% de objeto
%-%-%-%-%-%-%-%
Para a análise da remoção de um objeto da imagem, utilizou-se uma
sequência de imagens fotografadas a cada 10s durante as quais é retirada
um livro de um estante de livro.
A figura \ref{fig4Diff1} é muito semelhante à imagem original, nas
figuras posteriores fez-se o movimento para a retirada do livro da
imagem, que é concluída na imagem \ref{fig4Diff4}.
Os valores de r podem ser vistos na tabela \ref{tab:livro}.

\begin{figure}[h!]
\begin{center}
\includegraphics[scale=0.25]{photos/livros/gBase} \label{livro}
\caption{Remoção de item: figura original a ser comparada}
\end{center}
\end{figure}
\vspace{-0.5cm}

\begin{figure}[h!]
\begin{center}
\subfloat[Imagem em t=0s ]{\includegraphics[scale=0.22]{photos/livros/g000}\label{fig4Diff1}}
\hspace{10mm}
\subfloat[Imagem em t=10s ]{\includegraphics[scale=0.22]{photos/livros/g010}\label{fig4Diff2}}
\caption{Comparação entre a imagem original: tempo até 10 segundos }
\end{center}
\end{figure}

\vspace{-0.5cm}

\begin{figure}[h!]
\begin{center}
\subfloat[Imagem em t=20s
 ]{\includegraphics[scale=0.22]{photos/livros/g020}\label{fig4Diff3}}
\hspace{10mm}
\subfloat[Livro retirado: t=30s ]{\includegraphics[scale=0.22]{photos/livros/g030}\label{fig4Diff4}}
\caption{Comparação entre a imagem original: tempo até 30s }
\end{center}
\end{figure}

\vspace{-1.0cm}
%-%-%-%-%-%-%
% Tabela com 
% todos os 
% resultados
%-%-%-%-%-%-%
\begin{table}[h!]
  \begin{center}
    \caption{Valor do coeficiente de Pearson para as várias imagens de
      remoção de um livro da estante}
    \begin{tabular}{|c|c|c|}
      \hline
      Figura original & Figura modificada & r\\
      \hline
      6 &  \ref{fig4Diff1} & 0.999600\\
      6 &  \ref{fig4Diff2} &  0.917454\\
      6 &  \ref{fig4Diff3} &   0.952869\\
      6 &  \ref{fig4Diff4} &   0.983264\\
      \hline
    \end{tabular}\label{tab:livro}
  \end{center}
\end{table}


%-%-%-%-%-%-%
% Teste Porta
%-%-%-%-%-%-%
\newpage
\subsection{Detecção de movimento}
As comparações a seguir foram feitas para analisar a movimentação de uma cena, como, por exemplo, em câmeras de
vigilância. Ou seja, foi realizada uma comparação entre uma sequência de imagens.

\subsubsection{Abertura de uma porta}
As imagens abaixo são uma sequência de imagens da
abertura de uma porta.

\begin{figure}[h!]
\begin{center}
\includegraphics[scale=0.35]{photos/porta/gBase} \label{porta}
\caption{Remoção de item: figura original a ser comparada}
\end{center}
\end{figure}

\vspace{-0.5cm}
\begin{figure}[h!]
\begin{center}
\subfloat[Imagem em t=0s ]{\includegraphics[scale=0.22]{photos/porta/g000}\label{fig5Diff1}}
\hspace{10mm}
\subfloat[Imagem em t=10s ]{\includegraphics[scale=0.22]{photos/porta/g010}\label{fig5Diff2}}
\caption{Comparação entre a imagem original: tempos 0s e 10 s }
\end{center}
\end{figure}

\vspace{-0.5cm}

\begin{figure}[h!]
\begin{center}
\subfloat[Imagem em t=20s
 ]{\includegraphics[scale=0.22]{photos/porta/g020}\label{fig5Diff3}}
\hspace{10mm}
\subfloat[Livro retirado: t=30s ]{\includegraphics[scale=0.22]{photos/porta/g030}\label{fig5Diff4}}
\caption{Comparação entre a imagem original: tempos 20s e 30s }
\end{center}
\end{figure}

\vspace{-0.5cm}

\begin{figure}[h!]
\begin{center}
\subfloat[Imagem em t=40s
 ]{\includegraphics[scale=0.22]{photos/porta/g040}\label{fig5Diff5}}
\hspace{10mm}
\subfloat[Imagem em t=50s ]{\includegraphics[scale=0.22]{photos/porta/g050}\label{fig5Diff6}}
\caption{Comparação entre a imagem original: tempos 40s e 50s }
\end{center}
\end{figure}

\vspace{-0.5cm}
%-%-%-%-%-%-%-%-%-%-%-%-%
% Tabela com  resultados  
% da abertura de um porta
%-%-%-%-%-%-%-%-%-%-%-%-%
\begin{table}[h!]
  \begin{center}
    \caption{Valor do coeficiente de Pearson para sequência de imagens
      de abertura de um porta}
    \begin{tabular}{|c|c|c|}
      \hline
      Figura original & Figura modificada & r\\
      \hline
      10 &  \ref{fig5Diff1} & 0.996326\\
      10 &  \ref{fig5Diff2} & 0.995717\\
      10 &  \ref{fig5Diff3} & 0.952222\\
      10 &  \ref{fig5Diff4} & 0.862955\\
      10 &  \ref{fig5Diff5} & 0.798436\\
      10 &  \ref{fig5Diff6} & 0.818334\\
      \hline
    \end{tabular}
  \end{center}
\end{table}


%-%-%-%-%-%-%
% Teste Pessoa
%-%-%-%-%-%-%
\newpage
\subsubsection{Passagem de uma pessoa}
Para um outro teste dinâmico, obteve-se as sequências de imagens da
passagem de uma pessoa.

\begin{figure}[h!]
\begin{center}
\includegraphics[scale=0.35]{photos/pessoa/gBase}
\caption{Remoção de item: figura original a ser comparada}
\end{center}
\label{pessoa}
\end{figure}

\newpage
\begin{figure}[h!]
\begin{center}
\subfloat[Imagem em t=0s ]{\includegraphics[scale=0.26]{photos/pessoa/g000}\label{fig6Diff1}}
\hspace{10mm}
\subfloat[Imagem em t=10s ]{\includegraphics[scale=0.26]{photos/pessoa/g010}\label{fig6Diff2}}
\caption{Comparação entre a imagem original: tempos 0s e 10 s }
\end{center}
\end{figure}


\begin{figure}[h!]
\begin{center}
\subfloat[Imagem em t=20s
 ]{\includegraphics[scale=0.26]{photos/pessoa/g020}\label{fig6Diff3}}
\hspace{10mm}
\subfloat[Livro retirado: t=30s ]{\includegraphics[scale=0.26]{photos/pessoa/g030}\label{fig6Diff4}}
\caption{Comparação entre a imagem original: tempos 20s e 30s }
\end{center}
\end{figure}



%-%-%-%-%-%-%-%-%
% Tabela pessoa
%-%-%-%-%-%-%-%-%
\begin{table}[h!]
  \begin{center}
    \caption{Valor do coeficiente de Pearson para sequência de imagens
      da passagem de uma pessoa}
    \begin{tabular}{|c|c|c|}
      \hline
      Figura original & Figura modificada & r\\
      \hline
      13 &  \ref{fig6Diff1} & 0.999314\\
      13 &  \ref{fig6Diff2} & 0.972234\\
      13 &  \ref{fig6Diff3} & 0.971343\\
      13 &  \ref{fig6Diff4} & 0.986933\\
      \hline
    \end{tabular}
  \end{center}
\end{table}


%-%-%-%-%-%-%
% Teste Luzes
%-%-%-%-%-%-%
\newpage
\subsection{Fator Luminosidade}
Para um outro teste dinâmico, obteve-se as sequências de imagens para
a iluminação do local.

\begin{figure}[h!]
\begin{center}
\includegraphics[scale=0.35]{photos/luzes/gBase}
\caption{Remoção de item: figura original a ser comparada}
\end{center}
\label{luzes}
\end{figure}

\begin{figure}[h!]
\begin{center}
\subfloat[Imagem em t=0s ]{\includegraphics[scale=0.22]{photos/luzes/g000}\label{fig7Diff1}}
\hspace{10mm}
\subfloat[Imagem em t=10s ]{\includegraphics[scale=0.22]{photos/luzes/g010}\label{fig7Diff2}}
\caption{Comparação entre a imagem original: tempos 0s e 10 s }
\end{center}
\end{figure}


\begin{figure}[h!]
\begin{center}
\subfloat[Imagem em t=20s
 ]{\includegraphics[scale=0.22]{photos/luzes/g020}\label{fig7Diff3}}
\hspace{10mm}
\subfloat[Livro retirado: t=30s ]{\includegraphics[scale=0.22]{photos/luzes/g030}\label{fig7Diff4}}
\caption{Comparação entre a imagem original: tempos 20s e 30s }
\end{center}
\end{figure}


\begin{figure}[h!]
\begin{center}
\subfloat[Imagem em t=20s
 ]{\includegraphics[scale=0.22]{photos/luzes/g040}\label{fig7Diff5}}
\hspace{10mm}
\subfloat[Livro retirado: t=30s ]{\includegraphics[scale=0.22]{photos/luzes/g050}\label{fig7Diff6}}
\caption{Comparação entre a imagem original: tempos 20s e 30s }
\end{center}
\end{figure}

%-%-%-%-%-%-%-%-%
% Tabela luzes
%-%-%-%-%-%-%-%-%
\begin{table}[h!]
  \begin{center}
    \caption{Valor do coeficiente de Pearson para sequência de imagens
      de iluminação do local}
    \begin{tabular}{|c|c|c|}
      \hline
      Figura original & Figura modificada & r\\
      \hline
      16 &  \ref{fig7Diff1} & 0.996326\\
      16 &  \ref{fig7Diff2} & 0.995717\\
      16 &  \ref{fig7Diff3} & 0.952222\\
      16 &  \ref{fig7Diff4} & 0.862955\\
      16 &  \ref{fig7Diff5} & 0.798435\\
      16 &  \ref{fig7Diff6} &  0.818334\\
      \hline
    \end{tabular}
  \end{center}
\end{table}
\newpage
\section{Resultados}
Agrupando os resultados na tabela \ref{tab:final} percebe-se que o
coeficiente de correlação de Pearson é realmente ineficaz, já que a
comparação cujo coeficiente foi o menor é próximo a $r=0.8$ referente
aos testes de iluminação no qual abriu-se a geladeira, e no teste de
abertura de uma porta.

A sobreposição de imagens pouco modificou o valor do coeficiente,
sendo que a sobreposição de um texto é literalmente imperceptível
enquanto a sobreposição de uma imagem só começa a ser perceptível se
sua transparência é mínima. Mesmo assim a alteração do coeficiente não
passa de 10\%.

A remoção de um objeto da figura, em nosso caso a remoção de um livro
na prateleira só teve uma variação próxima a 8\% no momento em que o
braço de uma pessoa apareceu na imagem. Contudo, quando somente o
livro sumiu o valor de $r$ é próximo a 98\% o que implica na não
percepção de uma mudança simples.

Na seção de detecção de movimento, a passagem de uma pessoa também
apresenta baixa mudança no valor do coeficiente ($r=0,97$), apenas
mudanças bruscas de mudança no ambiente como a abertura de uma porta
causaram impacto maior no valor do coeficiente.

Por fim a iluminação do ambiente, provocou mudanças diferentes a cada
tempo. Ao ligar a luz do local, as diferenças entre os valores dos
coeficientes em imagens em sequência chegou a $\Delta r=0.05 $. Já a
abertura de uma geladeira além de iluminar altera uma grande área da
figura, assim o valor de r aproxima-se de $r\approx 0.8$

%-%-%-%-%-%-%
% Tabela com 
% todos os 
% resultados
%-%-%-%-%-%-%
\begin{table}[h!]
  \begin{center}
    \caption{Valor do coeficiente de Pearson para todos as comparações}
    \begin{tabular}{|c|c|c|}
      \hline
      Figura original & Figura modificada & r\\
      \hline
      \ref{fig1} &  \ref{fig1Diff} &  0.887291 \\
      \ref{fig2} &  \ref{fig2Diff} &  0.907154\\
      \ref{fig3} &  \ref{fig3Diff1} & 0.994465\\
      \ref{fig3} & \ref{fig3Diff2} &  0.985331\\
      \ref{fig3} &  \ref{fig3Diff3} &  0.936883\\
      \ref{fig3} &  \ref{fig3Diff4} &  0.905874\\
      6 &  \ref{fig4Diff1} & 0.999600\\
      6 &  \ref{fig4Diff2} &  0.917454\\
      6 &  \ref{fig4Diff3} &   0.952869\\
      6 &  \ref{fig4Diff4} &   0.983264\\
      10 &  \ref{fig5Diff1} & 0.996326\\
      10 &  \ref{fig5Diff2} & 0.995717\\
      10 &  \ref{fig5Diff3} & 0.952222\\
      10 &  \ref{fig5Diff4} & 0.862955\\
      10 &  \ref{fig5Diff5} & 0.798436\\
      10 &  \ref{fig5Diff6} & 0.818334\\
      13 &  \ref{fig6Diff1} & 0.999314\\
      13 &  \ref{fig6Diff2} & 0.972234\\
      13 &  \ref{fig6Diff3} & 0.971343\\
      13 &  \ref{fig6Diff4} & 0.986933\\
      16 &  \ref{fig7Diff1} & 0.996326\\
      16 &  \ref{fig7Diff2} & 0.995717\\
      16 &  \ref{fig7Diff3} & 0.952222\\
      16 &  \ref{fig7Diff4} & 0.862955\\
      16 &  \ref{fig7Diff5} & 0.798435\\
      16 &  \ref{fig7Diff6} &  0.818334\\
      \hline
    \end{tabular}
  \end{center}\label{tab:final}
\end{table}



\newpage
\section{Conclusão}
Utilizamos o coeficiente de correlação de Pearson  
 como método de comparação de imagens. Foram feitas diversas
 comparações de forma a obter-se uma gama de resultados suficientes
 para a análise do coeficiente.

O coeficiente de correlação de Pearson, assim como em outras
avaliações na literatura, demonstrou-se inefetivo. Portanto, os
resultados corroboram com o artigo de Eugene K. Yen e
Roger G. Johnston.

%Necessária?
%\section{Agradecimentos}

% ******************************************************
% 		REFERENCIAS BIBLIOGRÁFICAS
% ******************************************************
%\section{Referências}
\bibliographystyle{plain}
\begin{small}
  \bibliography{referencias}
\end{small}

\end{document}
